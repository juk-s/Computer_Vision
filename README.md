# Лабораторная 1
**Задание:** Усредняющий фильтр Гаусса с переменным размером ядра и
параметрами гауссианы

## Теоретическая база
В обработке изображений гауссово размытие — это результат размытия изображения с помощью гауссовой функции.
Фильтр Гаусса используется для снижения шума и детализации изображения.  

Обработка изображения фильтром Гаусса - это свертка изображения с гауссовским ядром. Каждый пиксель заменяется взвешенным средним его окружения внутри окна. Чем ближе соседние пиксели к текущему, тем больше они влияют на результат.

**Ядро Гаусса**  
```math
G(m,n)=\frac{1}{2\piσ^2}e^{-\frac{m^2+n^2}{2\sigma^2}} , где
```

$m,n$ - расстояние до центра ядра  
$\sigma$ - стандартное отклонение гауссовского распределения. Показывает степень размытия  
$\frac{1}{2\piσ^2}$ - нормализация  

Пример ядра для размера ядра = 3, sigma=1.0  
```math
\begin{bmatrix}
0.059 & 0.097 & 0.059 \\
0.097 & 0.159 & 0.097 \\
0.059 & 0.097 & 0.059
\end{bmatrix}
```

**Фильтр Гаусса**  
```math
y(i,j)=\sum_\limits{m=-K/2}^{K/2}{\sum_\limits{n=-K/2}^{K/2}{G(m,n)\cdot x(i-m, j-n)}} , где
```
$y(i,j)$ - пиксель выходного изображения  
$K$ - размер ядра  
$G(m,n)$ - ядро Гаусса  

К каждому пикселю изображения применяется фильтр, в результате которого рассчитывается новое значение пикселя  

## Описание разработанной системы
1. Загрузка изображение и приведение к формату RGB
2. Нативная реализация усредняющего фильтра Гаусса с использованием библиотеки NumPy
   Алгоритм работы:
   * Расчет гауссовского ядра с учетом размера ядра и параметра $\sigma$
   * Обработка изображения с увеличением размера для расчета крайних пикселей с помощью отражения
   * Проход по изображению с применением гауссовского фильтра для каждого пикселя
   * Запись нового значения пикселя в итоговое изображение
4. Реализация с использованием библиотеки OpenCV ```cv.GaussianBlur```
5. Сравнение времени выполнения двух реализаций для разного размера окна

## Результаты работы
Результаты работы нативного алгоритма, алгоритма из openCv и визуализация гауссовского ядра для различных размеров ядра и параметра $\sigma$
<img width="1306" height="1190" alt="image" src="https://github.com/user-attachments/assets/776b78e6-7124-4c43-9cea-443a9410dd48" />

Результаты сравнения времени работы алгоритмов:
|index|kernel\_size|native\_time\_ms|openCv\_time\_ms|
|---|---|---|---|
|0|3|6131\.19261264801|0\.4893302917480469|
|1|5|6140\.930461883545|0\.6846904754638672|
|2|9|6309\.48851108551|1\.4026880264282227|
|3|15|6838\.410687446594|2\.283811569213867|

## Выводы по работе
1. Усредняющий фильтр Гаусса позволяет сглаживать изображение, уменьшая шум и устраняя ненужные детали. При этом возможна настройка фильтра для более или менее сильного сглаживания
2. Реализация с помощью библиотеки openCV работает в разы быстрее, чем нативная реализация. Для решений, требующих быстрой обработки, рекомендуется использовать оптимизированные методы из готовых библиотек
3. Нативная реализация может быть оптимизированна путем разложения на пару сверток с одномерными гауссовыми ядрами: вертикальную и горизонтальную

## Использованные источники
1. Wikipedia: Gaussian Blur (https://en.wikipedia.org/wiki/Gaussian_blur)
2. Richard Szeliski. Computer Vision: Algorithms and Applications
3. Документация OpenCV (https://docs.opencv.org/4.x/d4/d13/tutorial_py_filtering.html) 

