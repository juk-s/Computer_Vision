# Лабораторная 3
Задание:
1. Выбрать цель для задачи классификации и датасет (train/val: собрать либо найти, например, на Kaggle, test: собрать, разметить, не менее 50 изображений).
2. Зафиксировать архитектуру сети, loss, метрики качества.
3. Натренировать (либо дотренировать сеть) на выбранном датасете
4. Оценить качество работы по выбранной метрике на валидационной выборке,
определить, не переобучилась ли модель.

## Структура проекта
test_dataset - собранный датасет  
cv_lab3.ipynb - исходный код  
fruit_classifier_efficientnet_final.pth - веса модели

## Цель для задачи классификации
Классификация фруктов - Яблоко, Банан, Виноград, Манго, Клубника  
Исходный датасет: https://www.kaggle.com/datasets/utkarshsaxenadn/fruits-classification/data  
Исходный датасет разбит на обучающую, тестовую и валидационную выборки.  
Train: 1940 изображений в каждом классе  
Valid: 40 изображений в каждом классе  
Test: 20 изображений в каждом классе  

Для обучения сети были объеденены тестовая и валидационная выборки, а также добавлено по 40 изображений каждого класса из тренировочной выборки в валидационную

## Обработка изображений
Для обработки изображений был использовн `torchvision.transforms`  
* Обрезка изображения до размеров, используемых в модели
* Случайное отражение изображения (только для тренировочной выборки)
* Случайный поворот изображения (только для тренировочной выборки)
* Преобразование PIL Image в PyTorch Tensor
* Норализация цветовых каналов

## Архитектура сети
Для построения классификатора была использована нейронная сеть **EfficientNet B0**  
**Классификатор:** Последний слой был заменен на классификатор с 5 выходами для классификации изображений на 5 классов  
**Функция потерь:** кросс-энтропия  
**Оптимизатор:** Adam  
**Количество эпох обучения:** 30  

## Результаты обучения
Общая точность модели: 0.95
### График loss и accuracy на тренировочной и валидационной выборке
<img width="1489" height="989" alt="image" src="https://github.com/user-attachments/assets/777a0f7d-4543-4089-96da-b686aba5654b" />

### Матрица ошибок по классам
<img width="1442" height="590" alt="image" src="https://github.com/user-attachments/assets/8bad3c1a-c175-4cb6-a1e1-e12a34c8f545" />

## Тестирование модели
Для тестовых данных был собран датасет по 10 изображений каждого класса
### Матрица ошибок по классам
<img width="1102" height="989" alt="image" src="https://github.com/user-attachments/assets/7ed2a1eb-62bd-4443-a8da-479d746fccda" />

### Примеры предсказаний модели
<img width="2490" height="1280" alt="image" src="https://github.com/user-attachments/assets/6461e1a7-0d7c-4564-b15d-19c62b4e8323" />




